<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Anonymous iframe</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <link href="https://www.w3.org/StyleSheets/TR/2021/cg-draft" rel="stylesheet">
  <meta content="Bikeshed version fb1e763a4, updated Tue Mar 1 13:13:50 2022 -0800" name="generator">
  <link href="https://wicg.github.io/anonymous-iframe/" rel="canonical">
  <meta content="7f68f344804ef03350fa5694b3535984de9b4e6e" name="document-revision">
<style>
.monkey-patch {
    padding: .5em;
    border: thin solid #ddd;
    border: thin solid 1px;
    border-radius: .5em;
    margin: .5em calc(-0.5em - 1px);
    background-color: rgba(255, 255, 0, 0.03);
    backdrop-filter: blur(5px);
    box-shadow: 0px 5px 5px 0px rgba(0, 0, 0, 0.05);
}

.brief {
  line-height: 10%;
}
</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-dfn-panel */

:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    height: auto;
    width: -webkit-fit-content;
    width: fit-content;
    max-width: 300px;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-issues */

a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-wpt */

:root {
    --wpt-border: hsl(0, 0%, 60%);
    --wpt-bg: hsl(0, 0%, 95%);
    --wpt-text: var(--text);
    --wptheading-text: hsl(0, 0%, 30%);
}
@media (prefers-color-scheme: dark) {
    :root {
        --wpt-border: hsl(0, 0%, 30%);
        --wpt-bg: var(--borderedblock-bg);
        --wpt-text: var(--text);
        --wptheading-text: hsl(0, 0%, 60%);
    }
}
.wpt-tests-block {
    list-style: none;
    border-left: .5em solid var(--wpt-border);
    background: var(--wpt-bg);
    color: var(--wpt-text);
    margin: 1em auto;
    padding: .5em;
}
.wpt-tests-block summary {
    color: var(--wptheading-text);
    font-weight: normal;
    text-transform: uppercase;
}
.wpt-tests-block summary::marker{
    color: var(--wpt-border);
}
.wpt-tests-block summary:hover::marker{
    color: var(--wpt-text);
}
/*
   The only content  of a wpt test block in its closed state is the <summary>,
   which contains the word TESTS,
   and that is absolutely positioned.
   In that closed state, wpt test blocks are styled
   to have a top margin whose height is exactly equal
   to the height of the absolutely positioned <summary>,
   and no other background/padding/margin/border.
   The wpt test block elements will therefore allow the maring
   of the previous/next block elements
   to collapse through them;
   if this combined margin would be larger than its own top margin,
   it stays as is,
   and therefore the pre-existing vertical rhythm of the document is undisturbed.
   If that combined margin would be smaller, it is grown to that size.
   This means that the wpt test block ensures
   that there's always enough vertical space to insert the summary,
   without adding more than is needed.
*/
.wpt-tests-block:not([open]){
    padding: 0;
    border: none;
    background: none;
    font-size: 0.75em;
    line-height: 1;
    position: relative;
    margin: 1em 0 0;
}
.wpt-tests-block:not([open]) summary {
    position: absolute;
    right: 0;
    bottom: 0;
}
/*
   It is possible that both the last child of a block element
   and the block element itself
   would be annotated with a <wpt> block each.
   If the block element has a padding or a border,
   that's fine, but otherwise
   the bottom margin of the block and of its last child would collapse
   and both <wpt> elements would overlap, being both placed there.
   To avoid that, add 1px of padding to the <wpt> element annotating the last child
   to prevent the bottom margin of the block and of its last child from collapsing
   (and as much negative margin,
   as wel only want to prevent margin collapsing,
   but are not trying to actually take more space).
*/
.wpt-tests-block:not([open]):last-child {
    padding-bottom: 1px;
    margin-bottom: -1px;
}
/*
   Exception to the previous rule:
   don't do that in non-last list items,
   because it's not necessary,
   and would therefore consume more space than strictly needed.
   Lists must have list items as children, not <wpt> elements,
   so a <wpt> element cannot be a sibling of a list item,
   and the collision that the previous rule avoids cannot happen.
*/
li:not(:last-child) > .wpt-tests-block:not([open]):last-child,
dd:not(:last-child) > .wpt-tests-block:not([open]):last-child {
    padding-bottom: 0;
    margin-bottom: 0;
}
.wpt-tests-block:not([open]):not(:hover){
    opacity: 0.5;
}
.wpt-tests-list {
    list-style: none;
    display: grid;
    margin: 0;
    padding: 0;
    grid-template-columns: 1fr max-content auto auto;
    grid-column-gap: .5em;
}
.wpt-tests-block hr:last-child {
    display: none;
}
.wpt-test {
    display: contents;
}
.wpt-test > a {
    text-decoration: underline;
    border: none;
}
.wpt-test > .wpt-name { grid-column: 1; }
.wpt-test > .wpt-results { grid-column: 2; }
.wpt-test > .wpt-live { grid-column: 3; }
.wpt-test > .wpt-source { grid-column: 4; }

.wpt-test > .wpt-results {
    display: flex;
    gap: .1em;
}
.wpt-test .wpt-result {
    display: inline-block;
    height: 1em;
    width: 1em;
    border-radius: 50%;
    position: relative;
}
</style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Anonymous iframe</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#CG-DRAFT">Draft Community Group Report</a>, <time class="dt-updated" datetime="2022-03-17">17 March 2022</time></p>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://wicg.github.io/anonymous-iframe/">https://wicg.github.io/anonymous-iframe/</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/WICG/anonymous-iframe/issues/">GitHub</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:arthursonzogni@google.com">Arthur Sonzogni</a> (<span class="p-org org">Google</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:clamy@google.com">Camille Lamy</a> (<span class="p-org org">Google</span>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright">©2022, Google, Inc. All rights reserved.</p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>Anonymous iframe give developers a way to load documents in third party iframe

  using new and ephemeral context. In return, the <a href="https://wicg.github.io/cross-origin-embedder-policy/">Cross-Origin-Embedder-Policy</a> (COEP) embedding rules can be lifted.</p>
   <p>This way, developers using COEP can now embed third party iframes that do not.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#recommended-readings"><span class="secno">1.1</span> <span class="content">Recommended readings</span></a>
      <li><a href="#problem"><span class="secno">1.2</span> <span class="content">A problem</span></a>
      <li>
       <a href="#explainer"><span class="secno">1.3</span> <span class="content">Explainer</span></a>
       <ol class="toc">
        <li><a href="#proposal-whatis"><span class="secno">1.3.1</span> <span class="content">What are anonymous iframes?</span></a>
        <li><a href="#proposal-credentials"><span class="secno">1.3.2</span> <span class="content">Anonymous iframes and credentials</span></a>
        <li><a href="#proposal-interactions"><span class="secno">1.3.3</span> <span class="content">How do anonymous iframes interact with COEP?</span></a>
        <li><a href="#proposal-autofill"><span class="secno">1.3.4</span> <span class="content">Anonymous iframes and autofill/password managers</span></a>
       </ol>
     </ol>
    <li><a href="#tests"><span class="secno">2</span> <span class="content">Tests</span></a>
    <li>
     <a href="#specification"><span class="secno">3</span> <span class="content">Specification</span></a>
     <ol class="toc">
      <li>
       <a href="#spec-html"><span class="secno">3.1</span> <span class="content">Integration with HTML</span></a>
       <ol class="toc">
        <li><a href="#spec-iframe-attribute"><span class="secno">3.1.1</span> <span class="content">The Iframe attribute</span></a>
        <li><a href="#spec-window-attribute"><span class="secno">3.1.2</span> <span class="content">The Window attribute</span></a>
        <li><a href="#spec-section"><span class="secno">3.1.3</span> <span class="content">General section</span></a>
       </ol>
      <li><a href="#spec-fetch"><span class="secno">3.2</span> <span class="content">Integration with Fetch</span></a>
     </ol>
    <li>
     <a href="#security"><span class="secno">4</span> <span class="content">Security considerations</span></a>
     <ol class="toc">
      <li><a href="#security-existing-credentials"><span class="secno">4.1</span> <span class="content">Usage of existing credentials</span></a>
      <li><a href="#security-new-credentials"><span class="secno">4.2</span> <span class="content">Usage of new credentials</span></a>
      <li><a href="#security-network-id"><span class="secno">4.3</span> <span class="content">Personalized resources based on network position</span></a>
      <li><a href="#security-user-input-capture"><span class="secno">4.4</span> <span class="content">Capture of user input</span></a>
      <li><a href="#security-side-channel"><span class="secno">4.5</span> <span class="content">Anonymous iframes using side-channels to personalize themselves</span></a>
     </ol>
    <li><a href="#privacy"><span class="secno">5</span> <span class="content">Privacy considerations</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
<script>
  setTimeout(() => location.reload(), 5000);
</script>
   <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
   <p><em>This section is not normative.</em></p>
   <h3 class="heading settled" data-level="1.1" id="recommended-readings"><span class="secno">1.1. </span><span class="content">Recommended readings</span><a class="self-link" href="#recommended-readings"></a></h3>
   <ul>
    <li data-md>
     <p>The <a data-link-type="biblio" href="#biblio-spectre">[Spectre]</a> vulnerability.</p>
    <li data-md>
     <p>The <a data-link-type="biblio" href="#biblio-coep-require-corp">[COEP-require-corp]</a> and <a data-link-type="biblio" href="#biblio-coep-credentialless">[COEP-credentialless]</a> headers.</p>
    <li data-md>
     <p>How and why <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#cross-origin-opener-policies" id="ref-for-cross-origin-opener-policies">Cross-Origin-Opener-Policy</a> (<a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#cross-origin-opener-policies" id="ref-for-cross-origin-opener-policies①">COOP</a>) and <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#coep" id="ref-for-coep">Cross-Origin-Embedder-Policy</a> (<a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#coep" id="ref-for-coep①">COEP</a>) are granting the <a href="concept-settings-object-cross-origin-isolated-capability">crossOriginIsolated</a> capability. See <a data-link-type="biblio" href="#biblio-whycoopcoep">[WhyCoopCoep]</a>.</p>
   </ul>
   <h3 class="heading settled" data-level="1.2" id="problem"><span class="secno">1.2. </span><span class="content">A problem</span><a class="self-link" href="#problem"></a></h3>
   <p>Deploying <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#coep" id="ref-for-coep②">COEP</a> is difficult for some developers, because of third party
iframes. Here is the typical scenario:</p>
   <ol>
    <li data-md>
     <p>End users needs performant websites.</p>
    <li data-md>
     <p>Some developers get performant websites, by using
 multithreading/<code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-sharedarraybuffer-objects" id="ref-for-sec-sharedarraybuffer-objects">SharedArrayBuffer</a></code> in their top-level document.</p>
    <li data-md>
     <p>To mitigate <a data-link-type="biblio" href="#biblio-spectre">[Spectre]</a> attacks, browsers vendors like Chrome, Firefox and
 Safari gate <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-sharedarraybuffer-objects" id="ref-for-sec-sharedarraybuffer-objects①">SharedArrayBuffer</a></code> usage behind the <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#concept-settings-object-cross-origin-isolated-capability" id="ref-for-concept-settings-object-cross-origin-isolated-capability">crossOriginIsolated</a> capability. This requires deploying both <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#coep" id="ref-for-coep③">COEP</a> and <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#cross-origin-opener-policies" id="ref-for-cross-origin-opener-policies②">COOP</a></p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#coep" id="ref-for-coep④">COEP</a> requirement is recursive: third party iframes are required to
 deploy <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#coep" id="ref-for-coep⑤">COEP</a> in order to be embeddable inside a <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#coep" id="ref-for-coep⑥">COEP</a> parent.</p>
    <li data-md>
     <p>Waiting for third party to deploy <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#coep" id="ref-for-coep⑦">COEP</a> is painful for developers. This
 is often out of their control most of the time.</p>
   </ol>
   <p>Beyond performance, there are additionnal features gated behind the <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#concept-settings-object-cross-origin-isolated-capability" id="ref-for-concept-settings-object-cross-origin-isolated-capability①">crossOriginIsolated</a> capability: <a data-link-type="dfn" href="https://www.w3.org/TR/hr-time//issues/1#issuecomment-812" id="ref-for-issuecomment-812">high resolution timers</a>, <a data-link-type="dfn" href="https://github.com/w3c/mediacapture-viewport#/issues/1" id="ref-for-/issues/1">getViewportMedia</a>, etc...</p>
   <p>Deploying <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#coep" id="ref-for-coep⑧">COEP</a> is challenging in cases where there’s not a single developer
involved, but many. Google Ads, for example, includes third-party content, and
it seems somewhat unlikely that they’ll be able to ensure that all the ads
creators will do the work to opt-into being loadable.</p>
   <h3 class="heading settled" data-level="1.3" id="explainer"><span class="secno">1.3. </span><span class="content">Explainer</span><a class="self-link" href="#explainer"></a></h3>
   <p><a data-link-type="biblio" href="#biblio-coep-require-corp">[COEP-require-corp]</a> currently tackles data leak attacks by ensuring that
cross-origin resources explicitly opt into being loaded in an environment with
higher risks. This way, servers can protect vulnerable resources by not having
them opt into being loaded in high risk environments.</p>
   <p>It would be ideal if we could find an approach that provided robust-enough
protection against accidental cross-process leakage without requiring an
explicit opt-in.</p>
   <p><a data-link-type="biblio" href="#biblio-coep-credentialless">[COEP-credentialless]</a> fixed the problem for simple subresources: Instead of
requiring an opt-in from the response, the resource is requested without
credentials. This way, only public resources are potentially leaked to the
attacker. They don’t bring any additional value to the attacker.</p>
   <p><strong>Anonymous iframes</strong> are similar, but for <code>&lt;iframe></code>.
Iframes are more difficult to tackle. They not only fetch a resource via a
navigation request, but also create a new context. The new context is able to
fetch data on its own. It can also access data from storage APIs: <a data-link-type="biblio" href="#biblio-webstorage">[WebStorage]</a>, <a data-link-type="biblio" href="#biblio-indexeddb">[IndexedDB]</a>, <a data-link-type="biblio" href="#biblio-web-sql">[web-sql]</a>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#broadcasting-to-other-browsing-contexts" id="ref-for-broadcasting-to-other-browsing-contexts">BroadcastChannel</a>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#sharedworker" id="ref-for-sharedworker">SharedWorker</a>, <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#service-worker-obj" id="ref-for-service-worker-obj">ServiceWorker</a>, etc</p>
   <p>Anonymous iframes is a flag to load documents in iframes, using a new and
ephemeral context. This ensures only a "public" version of the embedded website
can be leaked to the attacker.</p>
   <h4 class="heading settled" data-level="1.3.1" id="proposal-whatis"><span class="secno">1.3.1. </span><span class="content">What are anonymous iframes?</span><a class="self-link" href="#proposal-whatis"></a></h4>
   <p>Documents can create anonymous iframes by adding an <code>anonymous</code> attribute to the
iframe tag:</p>
<pre class="language-html highlight"><c- p>&lt;</c-><c- f>iframe</c-> <c- e>anonymous</c-> <c- e>src</c-><c- o>=</c-><c- s>”https://example.com”</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->
</pre>
   <p>This property is stored on the iframe. It is also stored and inherited to new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-window" id="ref-for-concept-request-window">Window</a> loaded inside e.g.:</p>
   <p><img alt="anonymous inheritance" height="637" src="./resources/inheritance.png" width="504"></p>
   <p><em>Anonymous flag inheritance.</em></p>
   <p>Similar to sandbox flags, the attribute can be changed programmatically on the <code>&lt;iframe></code>. It will take effect on new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-window" id="ref-for-concept-request-window①">Window</a> loaded inside. It means the
effect will only take place after an additional navigation.</p>
   <p>The state of the anonymous flag is exposed to the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-window" id="ref-for-concept-request-window②">Window</a> through a read-only
constant attribute:</p>
<pre class="language-js highlight">window<c- p>.</c->anonymous
</pre>
   It is true for <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-window" id="ref-for-concept-request-window③">Window</a> loaded immediately inside an anonymous iframe, or
deeper below it. 
   <h4 class="heading settled" data-level="1.3.2" id="proposal-credentials"><span class="secno">1.3.2. </span><span class="content">Anonymous iframes and credentials</span><a class="self-link" href="#proposal-credentials"></a></h4>
   <p>Anonymous iframes cannot use existing credentials and shared storage for their
origin. They are given a blank slate. Unlike sandboxed frames, they can use
storage APIs and register cookies. However, those credentials and storage can
only be shared by documents in anonymous iframes in the page (provided they meet
origin restrictions). They will no longer be accessible once the page has
navigated. Essentially, anonymous iframes are given a temporary <a href="https://storage.spec.whatwg.org/#storage-shelf">storage
shelf</a> partitioned to anonymous
iframes in the page.</p>
   <p>To achieve this, we rely on modifying the <a href="https://storage.spec.whatwg.org/#storage-key">storage
key</a> used to access shared storage
by anonymous iframes. As part of the <a href="https://privacycg.github.io/storage-partitioning/">client-side storage partitioning
effort</a> (declined across <a href="https://github.com/wanderview/quota-storage-partitioning/blob/main/explainer.md">storage
APIs</a>, <a href="https://github.com/MattMenke2/Explainer---Partition-Network-State">network
state</a> and <a href="https://github.com/DCtheTall/CHIPS">Cookie State</a>), the storage key of an
environment will no longer be its simple origin as currently described in the
spec. Instead it will be a combination of the origin and the top-level site URL.
In an anonymous iframe, we will replace the top-level site URL in the partition
key by a nonce value, determined once per page. This nonce will be recomputed
every time the top-level frame navigates. This ensures that anonymous iframes
cannot share storage keys with non-anonymous iframes. Because the nonce is
changed on every page navigation, anonymous iframes do not share storage across
different pages, or across navigations.</p>
   <p><img alt="nonce in partition-key" height="866" src="./resources/partition-key.png" width="549"></p>
   <p><em>Storage and credentials are only shared among anonymous iframes, following normal site/origin access checks.</em></p>
   <p><img alt="page’s nonce" height="430" src="./resources/page-change-nonce.png" width="1196"></p>
   <p><em>Storage and credentials created by anonymous iframes are no longer accessible
after the top level frame navigated away because the Storage key for anonymous
iframes will have changed. This applies to top-level history navigations as
well, meaning that when the page navigates away, anything stored by anonymous
iframes can be cleared by the browser, unless the page was stored in a
back-forward cache.</em></p>
   <p>Popups opened by anonymous iframes are not anonymous. However, we impose that
popups opened by anonymous iframes are opened with rel = noopener set. This is
done to prevent OAuth popup flows from being used in anonymous iframes. See the
threat model part for a discussion on why we impose this restriction.</p>
   <h4 class="heading settled" data-level="1.3.3" id="proposal-interactions"><span class="secno">1.3.3. </span><span class="content">How do anonymous iframes interact with COEP?</span><a class="self-link" href="#proposal-interactions"></a></h4>
   <p>Our proposition is that anonymous iframes are safe enough to embed in a COEP
page, even if they haven’t opted to do so by sending a COEP header. Thus, when
navigating to a document in an anonymous iframe, we do not check whether it has
a COEP and CORP header, even if its parent does not have a COEP of unsafe-none.</p>
   <p>This also means that anonymous iframes can be embedded in cross-origin isolated
pages without documents in them having to deploy COEP.</p>
   <h4 class="heading settled" data-level="1.3.4" id="proposal-autofill"><span class="secno">1.3.4. </span><span class="content">Anonymous iframes and autofill/password managers</span><a class="self-link" href="#proposal-autofill"></a></h4>
   <p>Browsers that implement autofill or password manager functionalities should make
them unavailable in anonymous iframes. The goal of anonymous iframes is to
preserve storage critical to an iframe function, but to avoid users logging into
anonymous iframes. Autofill and password managers make logging in easier, and so
should be avoided to prevent users accidentally logging in. This also allows
anonymous iframes to have a threat model similar to a phishing page (see the
Threat model part of this explainer below).</p>
   <h2 class="heading settled" data-level="2" id="tests"><span class="secno">2. </span><span class="content">Tests</span><a class="self-link" href="#tests"></a></h2>
   <p>The proposal is backed by the following tests:</p>
   <p>Status: <a href="https://wpt.fyi/results/html/cross-origin-embedder-policy/anonymous-iframe/">https://wpt.fyi/results/html/cross-origin-embedder-policy/anonymous-iframe/</a></p>
   <h2 class="heading settled" data-level="3" id="specification"><span class="secno">3. </span><span class="content">Specification</span><a class="self-link" href="#specification"></a></h2>
   <h3 class="heading settled" data-level="3.1" id="spec-html"><span class="secno">3.1. </span><span class="content">Integration with HTML</span><a class="self-link" href="#spec-html"></a></h3>
   <p class="note" role="note"><span>Note:</span> This corresponds to the following HTML specification change: <a href="https://github.com/whatwg/html/pull/7695">whatwg/html/pull/7695</a>.</p>
   <h4 class="heading settled" data-level="3.1.1" id="spec-iframe-attribute"><span class="secno">3.1.1. </span><span class="content">The Iframe attribute</span><a class="self-link" href="#spec-iframe-attribute"></a></h4>
   <p>In the <a href="https://html.spec.whatwg.org/#the-iframe-element">the iframe element</a> section, define the HTML <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#the-iframe-element" id="ref-for-the-iframe-element">iframe</a> <a data-link-type="dfn" href="#attr-iframe-anonymous" id="ref-for-attr-iframe-anonymous">anonymous</a> attribute:</p>
   <div class="monkey-patch"> The <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="attr-iframe-anonymous" data-noexport id="attr-iframe-anonymous">anonymous</dfn> attribute, enables loading documents hosted by the <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#the-iframe-element" id="ref-for-the-iframe-element①">iframe</a> with a
new and ephemeral storage partition. It is a boolean value. The default is
false. </div>
   <p>It is exposed to the Javascript <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#HTMLIframeElement" id="ref-for-HTMLIframeElement">HTMLIFrameElement</a> interface:</p>
   <div class="monkey-patch">
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="idl-code" data-dfn-type="interface" data-export id="htmliframeelement"><code><c- g>HTMLIFrameElement</c-></code><a class="self-link" href="#htmliframeelement"></a></dfn> : <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/dom.html#htmlelement" id="ref-for-htmlelement"><c- n>HTMLElement</c-></a> {
  // [...]
  <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean"><c- b>boolean</c-></a> <dfn class="idl-code" data-dfn-for="HTMLIFrameElement" data-dfn-type="attribute" data-export data-type="boolean" id="dom-htmliframeelement-anonymous"><code><c- g>anonymous</c-></code><a class="self-link" href="#dom-htmliframeelement-anonymous"></a></dfn>;
  // [...]
};
</pre>
    <p>The IDL attributes <dfn data-dfn-type="dfn" data-export data-lt="dom-iframe-anonymous" id="dom-iframe-anonymous">anonymous<a class="self-link" href="#dom-iframe-anonymous"></a></dfn>,
must <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-reflect" id="ref-for-concept-reflect">reflect</a> the respective content attributes of the same name.</p>
   </div>
   <h4 class="heading settled" data-level="3.1.2" id="spec-window-attribute"><span class="secno">3.1.2. </span><span class="content">The Window attribute</span><a class="self-link" href="#spec-window-attribute"></a></h4>
   <p>Add a read-only constant <code class="idl"><a data-link-type="idl" href="#dom-window-anonymous" id="ref-for-dom-window-anonymous">anonymous</a></code> attribute
to the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-window" id="ref-for-concept-request-window④">Window</a> object.</p>
   <div class="monkey-patch">
<pre class="idl highlight def">[
  <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Global" id="ref-for-Global"><c- g>Global</c-></a>=<a data-link-type="idl-name" href="#window" id="ref-for-window"><c- n>Window</c-></a>,
  <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=<c- n>Window</c->,
  <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#LegacyUnenumerableNamedProperties" id="ref-for-LegacyUnenumerableNamedProperties"><c- g>LegacyUnenumerableNamedProperties</c-></a>
]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="window"><code><c- g>Window</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget"><c- n>EventTarget</c-></a> {
  // ...
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean①"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="Window" data-dfn-type="attribute" data-export data-readonly data-type="boolean" id="dom-window-anonymous"><code><c- g>anonymous</c-></code></dfn>;
  // ...
};
</pre>
   </div>
   <h4 class="heading settled" data-level="3.1.3" id="spec-section"><span class="secno">3.1.3. </span><span class="content">General section</span><a class="self-link" href="#spec-section"></a></h4>
   <p>Add an "Anonymous iframe" sub-section inside <a href="https://html.spec.whatwg.org/C/#browsers">Loading web
pages</a> section, in between the <a href="https://html.spec.whatwg.org/C/#sandboxing">Sandboxing
one</a> and the <a href="https://html.spec.whatwg.org/C/#sandboxing">Sandboxing
one</a> and the <a href="https://html.spec.whatwg.org/C/#cross-origin-opener-policies" id="termref-for-cross-origin-opener-policies">Cross-origin opener
policies</a> ones:</p>
   <div class="monkey-patch"> <strong>7.7 Anonymous iframe</strong> </div>
   <div class="monkey-patch"> Each <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#dom-requestdestination-iframe" id="ref-for-dom-requestdestination-iframe">iframe</a></code> element has a mutable <a data-link-type="dfn" href="#attr-iframe-anonymous" id="ref-for-attr-iframe-anonymous①">anonymous</a> flag attribute. </div>
   <div class="monkey-patch">
     Each <code class="idl"><a data-link-type="idl" href="#window" id="ref-for-window①">Window</a></code> has a constant <code class="idl"><a data-link-type="idl" href="#dom-window-anonymous" id="ref-for-dom-window-anonymous①">anonymous</a></code> flag. 
    <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="anonymous-window">anonymous Window</dfn> is a <code class="idl"><a data-link-type="idl" href="#window" id="ref-for-window②">Window</a></code>, whose <code class="idl"><a data-link-type="idl" href="#dom-window-anonymous" id="ref-for-dom-window-anonymous②">anonymous</a></code> flag is true.</p>
   </div>
   <div class="monkey-patch">
     To compute the <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="initial-window-anonymous" id="initial-window-anonymous">initial window
  anonymous flag</dfn>, given a new <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#concept-document-bc" id="ref-for-concept-document-bc">browsing
  context</a> <var>browsing context</var>: 
    <ol class="brief">
     <li>
      <p>Set <var>embedder</var> be <var>browsing context</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#bc-container" id="ref-for-bc-container">container</a>.</p>
     <li>
      <p>If <var>embedder</var> is not an element, return false.</p>
     <li>
      <p>Otherwise, set <var>parentWindow</var> be the <var>embedder</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document">node
   document</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global">relevant global object</a>.</p>
     <li>
      <p>Return the union of:</p>
      <ul class="brief">
       <li>
        <p><var>parentWindow</var>’s <code class="idl"><a data-link-type="idl" href="#dom-window-anonymous" id="ref-for-dom-window-anonymous③">anonymous</a></code></p>
       <li>
        <p><var>embedder</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#the-iframe-element" id="ref-for-the-iframe-element②">iframe</a>’s <a data-link-type="dfn" href="#attr-iframe-anonymous" id="ref-for-attr-iframe-anonymous②">anonymous</a></p>
      </ul>
    </ol>
   </div>
   <div class="monkey-patch"> To compute the <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="navigation-anonymous" id="navigation-anonymous">navigation’s anonymous flag</dfn>,
given <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#concept-document-bc" id="ref-for-concept-document-bc①">browsing context</a> <var>browsing
context</var>, follows the same steps as in the <a data-link-type="dfn" href="#initial-window-anonymous" id="ref-for-initial-window-anonymous">initial window anonymous flag</a> algorithm. </div>
   <p>Add several notes in the general section, gathering changes spread elsewhere in
the other algorithms.</p>
   <div class="monkey-patch">
    <p class="note" role="note"><span>Note:</span> New <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-window" id="ref-for-concept-request-window⑤">Window</a>'s <code class="idl"><a data-link-type="idl" href="#dom-window-anonymous" id="ref-for-dom-window-anonymous④">anonymous</a></code> flag is computed either from the <a data-link-type="dfn" href="#initial-window-anonymous" id="ref-for-initial-window-anonymous①">initial window anonymous flag</a> algorithm for
new <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#concept-document-bc" id="ref-for-concept-document-bc②">browsing context</a>, or from the <a data-link-type="dfn" href="#navigation-anonymous" id="ref-for-navigation-anonymous">navigation’s anonymous flag</a> algorithm, executed
when the navigation started, for navigations inside pre-existing <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#concept-document-bc" id="ref-for-concept-document-bc③">browsing context</a>.</p>
    <p class="note" role="note"><span>Note:</span> Popup opened from <a data-link-type="dfn" href="#anonymous-window" id="ref-for-anonymous-window">anonymous Window</a> are always with <code>noopener</code> set.</p>
    <p class="note" role="note"><span>Note:</span> Top-level <a data-link-type="dfn" href="#anonymous-window" id="ref-for-anonymous-window①">anonymous Window</a> do not exist.</p>
   </div>
   <p>Defining the <a data-link-type="dfn" href="#page-anonymous-nonce" id="ref-for-page-anonymous-nonce">page anonymous nonce</a>.</p>
   <div class="monkey-patch">
    <p>Each top-level <code class="idl"><a data-link-type="idl" href="#window" id="ref-for-window③">Window</a></code> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="page-anonymous-nonce">page anonymous nonce</dfn>. It
  is an immutable nonce ("number used once").</p>
   </div>
   <p>Define how browsers should handle their autofill features.</p>
   <div class="monkey-patch">
    <p><dfn data-dfn-type="dfn" data-export id="autofill-and-anonymous-iframe">Autofill and anonymous iframe<a class="self-link" href="#autofill-and-anonymous-iframe"></a></dfn>: User agents sometimes have features for helping users
  fill forms in: for example prefilling the user’s address, password, or payment informations. User
  agents must disable those features when the data is both specific to the user and to the website. </p>
   </div>
   <h3 class="heading settled" data-level="3.2" id="spec-fetch"><span class="secno">3.2. </span><span class="content">Integration with Fetch</span><a class="self-link" href="#spec-fetch"></a></h3>
   <h2 class="heading settled" data-level="4" id="security"><span class="secno">4. </span><span class="content">Security considerations</span><a class="self-link" href="#security"></a></h2>
   <p>Because anonymous iframes can be embedded in <a data-link-type="dfn" href="https://html.spec.whatwg.org/C/#concept-settings-object-cross-origin-isolated-capability" id="ref-for-concept-settings-object-cross-origin-isolated-capability②">crossOriginIsolated</a> contexts,
in browsers without Out-of-Process-Iframes, we have to consider that their
embedder can perform a <a data-link-type="biblio" href="#biblio-spectre">[Spectre]</a> attack to read any of the anonymous iframes
resources, including the HTML. Our approach to this threat is not to prevent the
attack from happening, but to avoid loading personalized data so that an
attacker has only access to publicly available data.</p>
   <p>To do so, we consider a variety of possible attacks:</p>
   <h3 class="heading settled" data-level="4.1" id="security-existing-credentials"><span class="secno">4.1. </span><span class="content">Usage of existing credentials</span><a class="self-link" href="#security-existing-credentials"></a></h3>
   <p>The most dangerous attack is also the most straightforward. The attacker embeds
an anonymous iframe with resources for which the user already has credentials.
The attacker then reads the personalized resources inside the iframe, which are
not public data.</p>
   <p><strong>Mitigation:</strong></p>
   <p>Anonymous iframes do not have access to existing credentials stored by their
origin. This includes cookies. This also includes any data in the origin shared
storage, as it could have been retrieved using credentials, hence personalized.
Anonymous iframes start from a blank slate to prevent an attacker from loading
resources using existing credentials.</p>
   <h3 class="heading settled" data-level="4.2" id="security-new-credentials"><span class="secno">4.2. </span><span class="content">Usage of new credentials</span><a class="self-link" href="#security-new-credentials"></a></h3>
   <p>In this attack, the attacker embeds an anonymous iframe. As explained above, the
anonymous iframe starts from a blank slate when it comes to credentials and
shared storage. However, the anonymous iframe could register new credentials and
use those to request personalized resources. The attacker can then read those.
In practice, we can divide this scenario into two. First usage of credentials
storing state necessary to make the iframe site work, but which is not
particular to a user. This case is not problematic, as it is publicly accessible
data. The second one is state personalized by user, which would be acquired
after the user logs into the anonymous iframe.</p>
   <p>Finally, there is the question of how long such credentials should persist, and
how they should be shared across anonymous iframes. For example, one could
imagine that the user visits a legitimate page with an anonymous iframe A where
they log in. Then they visit an attacker page with an anonymous iframe of the
same origin A. If they are still logged into A, the attacker page could steal
data from personalized subresources.</p>
   <p><strong>Mitigation:</strong></p>
   <p>If the user is directly typing their credentials in the iframe to log-in, they
are logging into the iframe, in a page with a different URL shown in the
omnibox. This is similar to a phishing attack both in user action needed for the
attack to happen and outcome. This case shouldn’t require extra-mitigation.</p>
   <p>When the user is using a popup-driven OAuth flow (or the upcoming WebID API),
the situation is harder to understand from the user’s perspective. To prevent
this from happening, we restrict the iframe ability to open popups (e.g. all
popups are opened with no-opener set), and access the WebID API when it ships.</p>
   <p>In terms of lifetime and sharing of credentials, they are bound to the lifetime
of the anonymous iframe. So if a page creates an anonymous iframe, documents in
the subtree of the anonymous iframe get a clean slate of credentials and shared
storage. Documents in the subtree can create credentials. They can share them
among themselves (as long as they respect the same-origin policy), and only
among themselves. So if two pages are opened at the same time with two anonymous
iframes with the same origin, the anonymous iframes cannot share their
credentials. Once the anonymous iframe is destroyed, the credentials that were
created in its subtree should no longer be accessible. This ensures that we
preserve as much functionality for the anonymous iframe as possible, while
minimizing the risk of accidentally leaking data.</p>
   <h3 class="heading settled" data-level="4.3" id="security-network-id"><span class="secno">4.3. </span><span class="content">Personalized resources based on network position</span><a class="self-link" href="#security-network-id"></a></h3>
   <p>This is a variant of the previous attack, where the user embeds an iframe with
private subresources the user is only allowed to access due to their network
position. For example, resources found on the user private network, or resources
personalized based on a user IP address.</p>
   <p><strong>Mitigation:</strong></p>
   <p>We plan on dealing with the private network case by deploying Private Network
Access restrictions. During the CORS preflight introduced by <a href="https://wicg.github.io/private-network-access/">Private Network
Access restrictions</a>, the
servers will be able to check that their resource will be rendered in an
anonymous iframe context by checking the Sec-Fetch-COEP header. Note that only
local-network documents which enable HTTPS could potentially be exposed (because
MIX should prevent HTTP resources from being loaded by a page with COI). This
isn’t a strong mitigation, but will matter for things like common IoT devices.
The other cases of resources personalized based on IP address are arguably a
security footgun already. We think that the increased risk there is okay
compared to the advantage of not using credentials on more requests overall.</p>
   <h3 class="heading settled" data-level="4.4" id="security-user-input-capture"><span class="secno">4.4. </span><span class="content">Capture of user input</span><a class="self-link" href="#security-user-input-capture"></a></h3>
   <p>In this attack, the attacker embeds an anonymous iframe that can receive user
input. It then reads the user input.</p>
   <p><strong>Mitigation:</strong></p>
   <p>This is not in scope for anonymous iframes. An attacker can already do a
phishing attack where they construct a fake page using publicly available
resources and trick the user into entering data. This attack is equivalent,
since the URL shown to the user in the navigation bar will still be that of the
attacker.</p>
   <h3 class="heading settled" data-level="4.5" id="security-side-channel"><span class="secno">4.5. </span><span class="content">Anonymous iframes using side-channels to personalize themselves</span><a class="self-link" href="#security-side-channel"></a></h3>
   <p>The anonymous iframe could use side-channels (e.g. broadcast channels,
postMessage) to attempt to get a form of personalization despite the lack of
credentials. The personalized resources are then readable by the embedder.</p>
   <p><strong>Mitigation:</strong></p>
   <p>Depending on whether the mechanisms highlighted above are a common way of
personalizing resources, this might be out-of-scope. What we want to defend
against is unsuspecting websites being embedded and attacked by their embedder
to steal user data. If the anonymous iframe is bent on escaping the constraints
of anonymous iframes to personalize itself, then one can argue that it
understands the contexts and risks it is loaded in and accepts them. Provided
our security model is safe enough outside of anonymous iframes, the
personalization will only affect resources that are same-origin with the iframe
anyway. Cross-origin resources to the framed document will still be
unpersonalized, making this equivalent to COEP:credentiallesss from a security
perspective.</p>
   <h2 class="heading settled" data-level="5" id="privacy"><span class="secno">5. </span><span class="content">Privacy considerations</span><a class="self-link" href="#privacy"></a></h2>
   <p>The main privacy threat posed by this API is the risk of a data leak through a
side channel attack like <a data-link-type="biblio" href="#biblio-spectre">[Spectre]</a>. As detailed in the threat model above, we
believe the API provides a meaningful defense against <a data-link-type="biblio" href="#biblio-spectre">[Spectre]</a> attacks, and thus
does not pose a privacy risk.</p>
  </main>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li>
    anonymous
    <ul>
     <li><a href="#dom-htmliframeelement-anonymous">attribute for HTMLIFrameElement</a><span>, in § 3.1.1</span>
     <li><a href="#dom-window-anonymous">attribute for Window</a><span>, in § 3.1.2</span>
    </ul>
   <li><a href="#anonymous-window">anonymous Window</a><span>, in § 3.1.3</span>
   <li><a href="#attr-iframe-anonymous">attr-iframe-anonymous</a><span>, in § 3.1.1</span>
   <li><a href="#autofill-and-anonymous-iframe">Autofill and anonymous iframe</a><span>, in § 3.1.3</span>
   <li><a href="#dom-iframe-anonymous">dom-iframe-anonymous</a><span>, in § 3.1.1</span>
   <li><a href="#htmliframeelement">HTMLIFrameElement</a><span>, in § 3.1.1</span>
   <li><a href="#initial-window-anonymous">initial-window-anonymous</a><span>, in § 3.1.3</span>
   <li><a href="#navigation-anonymous">navigation-anonymous</a><span>, in § 3.1.3</span>
   <li><a href="#page-anonymous-nonce">page anonymous nonce</a><span>, in § 3.1.3</span>
   <li><a href="#window">Window</a><span>, in § 3.1.2</span>
  </ul>
  <aside class="dfn-panel" data-for="term-for-eventtarget">
   <a href="https://dom.spec.whatwg.org/#eventtarget">https://dom.spec.whatwg.org/#eventtarget</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-eventtarget">3.1.2. The Window attribute</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-node-document">
   <a href="https://dom.spec.whatwg.org/#concept-node-document">https://dom.spec.whatwg.org/#concept-node-document</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-node-document">3.1.3. General section</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-reflect">
   <a href="https://dom.spec.whatwg.org/#concept-reflect">https://dom.spec.whatwg.org/#concept-reflect</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-reflect">3.1.1. The Iframe attribute</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-sharedarraybuffer-objects">
   <a href="https://tc39.es/ecma262/#sec-sharedarraybuffer-objects">https://tc39.es/ecma262/#sec-sharedarraybuffer-objects</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-sharedarraybuffer-objects">1.2. A problem</a> <a href="#ref-for-sec-sharedarraybuffer-objects①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-requestdestination-iframe">
   <a href="https://fetch.spec.whatwg.org/#dom-requestdestination-iframe">https://fetch.spec.whatwg.org/#dom-requestdestination-iframe</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-requestdestination-iframe">3.1.3. General section</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-window">
   <a href="https://fetch.spec.whatwg.org/#concept-request-window">https://fetch.spec.whatwg.org/#concept-request-window</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-window">1.3.1. What are anonymous iframes?</a> <a href="#ref-for-concept-request-window①">(2)</a> <a href="#ref-for-concept-request-window②">(3)</a> <a href="#ref-for-concept-request-window③">(4)</a>
    <li><a href="#ref-for-concept-request-window④">3.1.2. The Window attribute</a>
    <li><a href="#ref-for-concept-request-window⑤">3.1.3. General section</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-htmlelement">
   <a href="https://html.spec.whatwg.org/multipage/dom.html#htmlelement">https://html.spec.whatwg.org/multipage/dom.html#htmlelement</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-htmlelement">3.1.1. The Iframe attribute</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-bc-container">
   <a href="https://html.spec.whatwg.org/C/#bc-container">https://html.spec.whatwg.org/C/#bc-container</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-bc-container">3.1.3. General section</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-broadcasting-to-other-browsing-contexts">
   <a href="https://html.spec.whatwg.org/C/#broadcasting-to-other-browsing-contexts">https://html.spec.whatwg.org/C/#broadcasting-to-other-browsing-contexts</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-broadcasting-to-other-browsing-contexts">1.3. Explainer</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-coep">
   <a href="https://html.spec.whatwg.org/C/#coep">https://html.spec.whatwg.org/C/#coep</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-coep">1.1. Recommended readings</a> <a href="#ref-for-coep①">(2)</a>
    <li><a href="#ref-for-coep②">1.2. A problem</a> <a href="#ref-for-coep③">(2)</a> <a href="#ref-for-coep④">(3)</a> <a href="#ref-for-coep⑤">(4)</a> <a href="#ref-for-coep⑥">(5)</a> <a href="#ref-for-coep⑦">(6)</a> <a href="#ref-for-coep⑧">(7)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-document-bc">
   <a href="https://html.spec.whatwg.org/C/#concept-document-bc">https://html.spec.whatwg.org/C/#concept-document-bc</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-document-bc">3.1.3. General section</a> <a href="#ref-for-concept-document-bc①">(2)</a> <a href="#ref-for-concept-document-bc②">(3)</a> <a href="#ref-for-concept-document-bc③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-cross-origin-opener-policies">
   <a href="https://html.spec.whatwg.org/C/#cross-origin-opener-policies">https://html.spec.whatwg.org/C/#cross-origin-opener-policies</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-cross-origin-opener-policies">1.1. Recommended readings</a> <a href="#ref-for-cross-origin-opener-policies①">(2)</a>
    <li><a href="#ref-for-cross-origin-opener-policies②">1.2. A problem</a>
    <li><a href="#termref-for-cross-origin-opener-policies">3.1.3. General section</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-coep">
   <a href="https://html.spec.whatwg.org/C/#coep">https://html.spec.whatwg.org/C/#coep</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-coep">1.1. Recommended readings</a> <a href="#ref-for-coep①">(2)</a>
    <li><a href="#ref-for-coep②">1.2. A problem</a> <a href="#ref-for-coep③">(2)</a> <a href="#ref-for-coep④">(3)</a> <a href="#ref-for-coep⑤">(4)</a> <a href="#ref-for-coep⑥">(5)</a> <a href="#ref-for-coep⑦">(6)</a> <a href="#ref-for-coep⑧">(7)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-cross-origin-opener-policies">
   <a href="https://html.spec.whatwg.org/C/#cross-origin-opener-policies">https://html.spec.whatwg.org/C/#cross-origin-opener-policies</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-cross-origin-opener-policies">1.1. Recommended readings</a> <a href="#ref-for-cross-origin-opener-policies①">(2)</a>
    <li><a href="#ref-for-cross-origin-opener-policies②">1.2. A problem</a>
    <li><a href="#termref-for-cross-origin-opener-policies">3.1.3. General section</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-settings-object-cross-origin-isolated-capability">
   <a href="https://html.spec.whatwg.org/C/#concept-settings-object-cross-origin-isolated-capability">https://html.spec.whatwg.org/C/#concept-settings-object-cross-origin-isolated-capability</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-settings-object-cross-origin-isolated-capability">1.2. A problem</a> <a href="#ref-for-concept-settings-object-cross-origin-isolated-capability①">(2)</a>
    <li><a href="#ref-for-concept-settings-object-cross-origin-isolated-capability②">4. Security considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-HTMLIframeElement">
   <a href="https://html.spec.whatwg.org/C/#HTMLIframeElement">https://html.spec.whatwg.org/C/#HTMLIframeElement</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-HTMLIframeElement">3.1.1. The Iframe attribute</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-the-iframe-element">
   <a href="https://html.spec.whatwg.org/C/#the-iframe-element">https://html.spec.whatwg.org/C/#the-iframe-element</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-the-iframe-element">3.1.1. The Iframe attribute</a> <a href="#ref-for-the-iframe-element①">(2)</a>
    <li><a href="#ref-for-the-iframe-element②">3.1.3. General section</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-relevant-global">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-relevant-global">3.1.3. General section</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-service-worker-obj">
   <a href="https://html.spec.whatwg.org/C/#service-worker-obj">https://html.spec.whatwg.org/C/#service-worker-obj</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-service-worker-obj">1.3. Explainer</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sharedworker">
   <a href="https://html.spec.whatwg.org/C/#sharedworker">https://html.spec.whatwg.org/C/#sharedworker</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sharedworker">1.3. Explainer</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Exposed">
   <a href="https://webidl.spec.whatwg.org/#Exposed">https://webidl.spec.whatwg.org/#Exposed</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Exposed">3.1.1. The Iframe attribute</a>
    <li><a href="#ref-for-Exposed①">3.1.2. The Window attribute</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Global">
   <a href="https://webidl.spec.whatwg.org/#Global">https://webidl.spec.whatwg.org/#Global</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Global">3.1.2. The Window attribute</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-LegacyUnenumerableNamedProperties">
   <a href="https://webidl.spec.whatwg.org/#LegacyUnenumerableNamedProperties">https://webidl.spec.whatwg.org/#LegacyUnenumerableNamedProperties</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-LegacyUnenumerableNamedProperties">3.1.2. The Window attribute</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-boolean">
   <a href="https://webidl.spec.whatwg.org/#idl-boolean">https://webidl.spec.whatwg.org/#idl-boolean</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-boolean">3.1.1. The Iframe attribute</a>
    <li><a href="#ref-for-idl-boolean①">3.1.2. The Window attribute</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-eventtarget">EventTarget</span>
     <li><span class="dfn-paneled" id="term-for-concept-node-document">node document</span>
     <li><span class="dfn-paneled" id="term-for-concept-reflect">reflect</span>
    </ul>
   <li>
    <a data-link-type="biblio">[ECMASCRIPT]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-sec-sharedarraybuffer-objects">SharedArrayBuffer</span>
    </ul>
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-dom-requestdestination-iframe">"iframe"</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-window">window</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-htmlelement">HTMLElement</span>
     <li><span class="dfn-paneled" id="term-for-bc-container">bc-container</span>
     <li><span class="dfn-paneled" id="term-for-broadcasting-to-other-browsing-contexts">broadcastchannel</span>
     <li><span class="dfn-paneled" id="term-for-coep">coep</span>
     <li><span class="dfn-paneled" id="term-for-concept-document-bc">concept-document-bc</span>
     <li><span class="dfn-paneled" id="term-for-cross-origin-opener-policies">coop</span>
     <li><span class="dfn-paneled" id="term-for-coep①">cross-origin-embedder-policy</span>
     <li><span class="dfn-paneled" id="term-for-cross-origin-opener-policies①">cross-origin-opener-policy</span>
     <li><span class="dfn-paneled" id="term-for-concept-settings-object-cross-origin-isolated-capability">crossoriginisolated</span>
     <li><span class="dfn-paneled" id="term-for-HTMLIframeElement">htmliframeelement</span>
     <li><span class="dfn-paneled" id="term-for-the-iframe-element">iframe</span>
     <li><span class="dfn-paneled" id="term-for-concept-relevant-global">relevant global object</span>
     <li><span class="dfn-paneled" id="term-for-service-worker-obj">serviceworker</span>
     <li><span class="dfn-paneled" id="term-for-sharedworker">sharedworker</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-Exposed">Exposed</span>
     <li><span class="dfn-paneled" id="term-for-Global">Global</span>
     <li><span class="dfn-paneled" id="term-for-LegacyUnenumerableNamedProperties">LegacyUnenumerableNamedProperties</span>
     <li><span class="dfn-paneled" id="term-for-idl-boolean">boolean</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-coep-credentialless">[COEP-credentialless]
   <dd>Arthur Sonzogni; et al. <a href="https://wicg.github.io/cross-origin-embedder-policy/"><cite>COEP: credentialless</cite></a>. URL: <a href="https://wicg.github.io/cross-origin-embedder-policy/">https://wicg.github.io/cross-origin-embedder-policy/</a>
   <dt id="biblio-coep-require-corp">[COEP-require-corp]
   <dd>Mike West. <a href="https://wicg.github.io/cross-origin-embedder-policy/"><cite>COEP</cite></a>. URL: <a href="https://wicg.github.io/cross-origin-embedder-policy/">https://wicg.github.io/cross-origin-embedder-policy/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-ecmascript">[ECMASCRIPT]
   <dd><a href="https://tc39.es/ecma262/multipage/"><cite>ECMAScript Language Specification</cite></a>. URL: <a href="https://tc39.es/ecma262/multipage/">https://tc39.es/ecma262/multipage/</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-indexeddb">[IndexedDB]
   <dd>Nikunj Mehta; et al. <a href="https://www.w3.org/TR/IndexedDB/"><cite>Indexed Database API</cite></a>. 8 January 2015. REC. URL: <a href="https://www.w3.org/TR/IndexedDB/">https://www.w3.org/TR/IndexedDB/</a>
   <dt id="biblio-spectre">[Spectre]
   <dd>Paul Kocher; et al. <a href="https://spectreattack.com/spectre.pdf"><cite>Spectre Attacks: Exploiting Speculative Execution</cite></a>. URL: <a href="https://spectreattack.com/spectre.pdf">https://spectreattack.com/spectre.pdf</a>
   <dt id="biblio-web-sql">[WEB-SQL]
   <dd>Ian Hickson. <a href="https://www.w3.org/TR/webdatabase/"><cite>Web SQL Database</cite></a>. 18 November 2010. NOTE. URL: <a href="https://www.w3.org/TR/webdatabase/">https://www.w3.org/TR/webdatabase/</a>
   <dt id="biblio-webstorage">[WebStorage]
   <dd>Ian Hickson. <a href="https://www.w3.org/TR/webstorage/"><cite>Web Storage (Second Edition)</cite></a>. 28 January 2021. REC. URL: <a href="https://www.w3.org/TR/webstorage/">https://www.w3.org/TR/webstorage/</a>
   <dt id="biblio-whycoopcoep">[WhyCoopCoep]
   <dd>Eiji Kitamura; Demenic Denicola. <a href="https://web.dev/why-coop-coep/"><cite>Why you need "cross-origin isolated" for powerful features</cite></a>. URL: <a href="https://web.dev/why-coop-coep/">https://web.dev/why-coop-coep/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#htmliframeelement"><code><c- g>HTMLIFrameElement</c-></code></a> : <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/dom.html#htmlelement"><c- n>HTMLElement</c-></a> {
  // [...]
  <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-type="boolean" href="#dom-htmliframeelement-anonymous"><code><c- g>anonymous</c-></code></a>;
  // [...]
};

[
  <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Global"><c- g>Global</c-></a>=<a data-link-type="idl-name" href="#window"><c- n>Window</c-></a>,
  <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->,
  <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#LegacyUnenumerableNamedProperties"><c- g>LegacyUnenumerableNamedProperties</c-></a>
]
<c- b>interface</c-> <a href="#window"><code><c- g>Window</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget"><c- n>EventTarget</c-></a> {
  // ...
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-readonly data-type="boolean" href="#dom-window-anonymous"><code><c- g>anonymous</c-></code></a>;
  // ...
};

</pre>
  <aside class="dfn-panel" data-for="attr-iframe-anonymous">
   <b><a href="#attr-iframe-anonymous">#attr-iframe-anonymous</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attr-iframe-anonymous">3.1.1. The Iframe attribute</a>
    <li><a href="#ref-for-attr-iframe-anonymous①">3.1.3. General section</a> <a href="#ref-for-attr-iframe-anonymous②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="window">
   <b><a href="#window">#window</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-window">3.1.2. The Window attribute</a>
    <li><a href="#ref-for-window①">3.1.3. General section</a> <a href="#ref-for-window②">(2)</a> <a href="#ref-for-window③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-window-anonymous">
   <b><a href="#dom-window-anonymous">#dom-window-anonymous</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-window-anonymous">3.1.2. The Window attribute</a>
    <li><a href="#ref-for-dom-window-anonymous①">3.1.3. General section</a> <a href="#ref-for-dom-window-anonymous②">(2)</a> <a href="#ref-for-dom-window-anonymous③">(3)</a> <a href="#ref-for-dom-window-anonymous④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="anonymous-window">
   <b><a href="#anonymous-window">#anonymous-window</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-anonymous-window">3.1.3. General section</a> <a href="#ref-for-anonymous-window①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="initial-window-anonymous">
   <b><a href="#initial-window-anonymous">#initial-window-anonymous</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-initial-window-anonymous">3.1.3. General section</a> <a href="#ref-for-initial-window-anonymous①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="navigation-anonymous">
   <b><a href="#navigation-anonymous">#navigation-anonymous</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-navigation-anonymous">3.1.3. General section</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="page-anonymous-nonce">
   <b><a href="#page-anonymous-nonce">#page-anonymous-nonce</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-page-anonymous-nonce">3.1.3. General section</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>